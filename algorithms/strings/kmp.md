# üîç Knuth-Morris-Pratt (KMP) String Matching  
**–ü–æ—à—É–∫ –ø—ñ–¥—Ä—è–¥–∫–∞ –≤ —Ä—è–¥–∫—É —á–µ—Ä–µ–∑ –ø—Ä–µ—Ñ—ñ–∫—Å-—Ñ—É–Ω–∫—Ü—ñ—é**

---

## üìò –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–¥—É–ª—è

> –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º **KMP** –¥–ª—è –ø–æ—à—É–∫—É —à–∞–±–ª–æ–Ω—É `P` –≤ —Ç–µ–∫—Å—Ç—ñ `T` –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –ø—Ä–µ—Ñ—ñ–∫—Å-—Ñ—É–Ω–∫—Ü—ñ—ó.  
> –ú–µ—Ç–∞ ‚Äî —É–Ω–∏–∫–Ω—É—Ç–∏ –∑–∞–π–≤–∏—Ö –ø–æ—Ä—ñ–≤–Ω—è–Ω—å, –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –ª—ñ–Ω—ñ–π–Ω—É —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å, —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–æ–¥—É–ª—å, —è–∫–∏–π –ª–µ–≥–∫–æ —ñ–Ω—Ç–µ–≥—Ä—É—î—Ç—å—Å—è –≤ –±—É–¥—å-—è–∫—É —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–æ–±–∫–∏ —Ä—è–¥–∫—ñ–≤.

---

## üß† –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ –ª–æ–≥—ñ–∫–∞ (—Ä–æ–∑—à–∏—Ä–µ–Ω–∞)

### üìê –ú–æ–¥–µ–ª—å

- **–í—Ö—ñ–¥**:
  - `text` ‚Äî —Ä—è–¥–æ–∫, —É —è–∫–æ–º—É –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø–æ—à—É–∫
  - `pattern` ‚Äî —à–∞–±–ª–æ–Ω, —è–∫–∏–π —à—É–∫–∞—î–º–æ
- **–í–∏—Ö—ñ–¥**:
  - –Ü–Ω–¥–µ–∫—Å–∏ –≤—Ö–æ–¥–∂–µ–Ω—å —à–∞–±–ª–æ–Ω—É –≤ —Ç–µ–∫—Å—Ç—ñ

- **–§—É–Ω–∫—Ü—ñ—ó**:
  - `compute_prefix_function()` ‚Äî –±—É–¥—É—î –ø—Ä–µ—Ñ—ñ–∫—Å-–º–∞—Å–∏–≤ –¥–ª—è —à–∞–±–ª–æ–Ω—É
  - `kmp_search()` ‚Äî –≤–∏–∫–æ–Ω—É—î –ø–æ—à—É–∫ –≤—Ö–æ–¥–∂–µ–Ω—å —à–∞–±–ª–æ–Ω—É –≤ —Ç–µ–∫—Å—Ç

---


## üíª –ü–æ–≤–Ω–∏–π –∫–æ–¥ –Ω–∞ C –∑ —Ç–µ—Å—Ç–∞–º–∏
```c
#include <stdio.h>
#include <string.h>

#define MAX_LEN 1000

// üîß –ü–æ–±—É–¥–æ–≤–∞ –ø—Ä–µ—Ñ—ñ–∫—Å-—Ñ—É–Ω–∫—Ü—ñ—ó
void compute_prefix_function(const char *pattern, int *prefix) {
    int m = strlen(pattern);
    prefix[0] = 0;
    int k = 0;

    for (int q = 1; q < m; q++) {
        while (k > 0 && pattern[k] != pattern[q])
            k = prefix[k - 1];
        if (pattern[k] == pattern[q])
            k++;
        prefix[q] = k;
    }
}

// üîß KMP –ø–æ—à—É–∫
void kmp_search(const char *text, const char *pattern) {
    int n = strlen(text);
    int m = strlen(pattern);
    int prefix[MAX_LEN];

    compute_prefix_function(pattern, prefix);

    int q = 0; // –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–±—ñ–≥—ñ–≤
    for (int i = 0; i < n; i++) {
        while (q > 0 && pattern[q] != text[i])
            q = prefix[q - 1];
        if (pattern[q] == text[i])
            q++;
        if (q == m) {
            printf("Match at index %d\n", i - m + 1);
            q = prefix[q - 1]; // –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –ø–æ—à—É–∫
        }
    }
}

// üîß –¢–µ—Å—Ç–∏
void run_tests() {
    const char *text1 = "ababcababcabc";
    const char *pattern1 = "ababc";

    const char *text2 = "aaaaabaaaabaa";
    const char *pattern2 = "aaabaa";

    printf("Test 1:\n");
    kmp_search(text1, pattern1);

    printf("\nTest 2:\n");
    kmp_search(text2, pattern2);
}

int main() {
    run_tests();
    return 0;
}
```

### üîÅ –õ–æ–≥—ñ–∫–∞

#### üîπ –ü—Ä–µ—Ñ—ñ–∫—Å-—Ñ—É–Ω–∫—Ü—ñ—è

- –î–ª—è –∫–æ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó `q` –≤ —à–∞–±–ª–æ–Ω—ñ:
  - –ó–Ω–∞—Ö–æ–¥–∏–º–æ –¥–æ–≤–∂–∏–Ω—É –Ω–∞–π–±—ñ–ª—å—à–æ–≥–æ –ø—Ä–µ—Ñ—ñ–∫—Å–∞, —è–∫–∏–π —î —Å—É—Ñ—ñ–∫—Å–æ–º –ø—ñ–¥—Ä—è–¥–∫–∞ `pattern[0..q]`
  - –¶–µ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏ –Ω–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—å –Ω–∞ –ø–æ—á–∞—Ç–æ–∫, –∞ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó

#### üîπ –ü–æ—à—É–∫

- –Ü—Ç–µ—Ä—É—î–º–æ –ø–æ —Ç–µ–∫—Å—Ç—É `text[i]`
- –Ø–∫—â–æ `text[i] == pattern[q]` ‚Äî –∑–±—ñ–ª—å—à—É—î–º–æ `q`
- –Ø–∫—â–æ `q == m` ‚Äî –∑–Ω–∞–π–¥–µ–Ω–æ –≤—Ö–æ–¥–∂–µ–Ω–Ω—è, –≤–∏–≤–æ–¥–∏–º–æ `i - m + 1`
- –ü—ñ—Å–ª—è –≤—Ö–æ–¥–∂–µ–Ω–Ω—è ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ `prefix[q - 1]` –¥–ª—è –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –ø–æ—à—É–∫—É

---

### üìä –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü—ñ—è         | –ß–∞—Å–æ–≤–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å | –ü–∞–º‚Äô—è—Ç—å |
|------------------|-------------------|---------|
| –ü—Ä–µ—Ñ—ñ–∫—Å-—Ñ—É–Ω–∫—Ü—ñ—è  | `O(m)`            | `O(m)`  |
| –ü–æ—à—É–∫            | `O(n)`            | `O(m)`  |
| –ó–∞–≥–∞–ª–æ–º          | `O(n + m)`        | `O(m)`  |

- `n` ‚Äî –¥–æ–≤–∂–∏–Ω–∞ —Ç–µ–∫—Å—Ç—É  
- `m` ‚Äî –¥–æ–≤–∂–∏–Ω–∞ —à–∞–±–ª–æ–Ω—É  
- –ü–æ—à—É–∫ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–µ–∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω—å —É —Ç–µ–∫—Å—Ç—ñ

---

### üß™ –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ

| –¢–µ—Å—Ç | –¢–µ–∫—Å—Ç               | –®–∞–±–ª–æ–Ω   | –í—Ö–æ–¥–∂–µ–Ω–Ω—è       |
|------|---------------------|----------|-----------------|
| 1    | `"ababcababcabc"`   | `"ababc"`| `0, 5`          |
| 2    | `"aaaaabaaaabaa"`   | `"aaabaa"`| `5`            |

- –í –∫–æ–∂–Ω–æ–º—É —Ç–µ—Å—Ç—ñ —à–∞–±–ª–æ–Ω –≤—Ö–æ–¥–∏—Ç—å –æ–¥–∏–Ω –∞–±–æ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤
- –ê–ª–≥–æ—Ä–∏—Ç–º –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –≤—Å—ñ –≤—Ö–æ–¥–∂–µ–Ω–Ω—è –±–µ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è

---

### üì¶ –ü–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

–ú–æ–¥—É–ª—å –º–æ–∂–Ω–∞ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –¥–ª—è:

- –ü–æ—à—É–∫—É –≤—Å—ñ—Ö –≤—Ö–æ–¥–∂–µ–Ω—å —à–∞–±–ª–æ–Ω—É –≤ —Ç–µ–∫—Å—Ç—ñ  
- –ü–æ—à—É–∫—É –∑ –æ–±—Ä–æ–±–∫–æ—é —Ä–µ–≥—ñ—Å—Ç—Ä—É, –ø—Ä–æ–±—ñ–ª—ñ–≤, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ñ–≤  
- –í–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∏, IDE, –ø–æ—à—É–∫–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏  
- –ü–æ—à—É–∫—É –≤ –ø–æ—Ç–æ–∫–∞—Ö, —Ñ–∞–π–ª–∞—Ö, –º–µ—Ä–µ–∂–µ–≤–∏—Ö –¥–∞–Ω–∏—Ö  
- –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ —ñ–Ω—à–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏: Rabin-Karp, Boyer-Moore  
- –ü–æ–±—É–¥–æ–≤–∏ —ñ–Ω–¥–µ–∫—Å—ñ–≤ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ—à—É–∫—É

---

### üßò –í–∏—Å–Ω–æ–≤–æ–∫

–¶–µ–π –º–æ–¥—É–ª—å ‚Äî –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è KMP. –í—ñ–Ω –ø–æ–∫–∞–∑—É—î:

- –Ø–∫ –±—É–¥—É–≤–∞—Ç–∏ –ø—Ä–µ—Ñ—ñ–∫—Å-—Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è —à–∞–±–ª–æ–Ω—É  
- –Ø–∫ —É–Ω–∏–∫–∞—Ç–∏ –∑–∞–π–≤–∏—Ö –ø–æ—Ä—ñ–≤–Ω—è–Ω—å –ø—Ä–∏ –ø–æ—à—É–∫—É  
- –Ø–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –≤—Å—ñ –≤—Ö–æ–¥–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –≤ —Ç–µ–∫—Å—Ç—ñ  
- –Ø–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—É–≤–∞—Ç–∏ –ø–æ—à—É–∫ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è  
- –Ø–∫ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Ç–µ–∫—Å—Ç—ñ–≤ —ñ –ø–æ—Ç–æ–∫—ñ–≤




---
