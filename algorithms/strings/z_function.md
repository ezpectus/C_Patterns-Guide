# üîç Z-Function for String Matching (C)  
**–ü–æ–±—É–¥–æ–≤–∞ Z-—Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä—è–¥–∫–∞ ‚Äî –ø–æ—à—É–∫ —à–∞–±–ª–æ–Ω—ñ–≤, –ø—Ä–µ—Ñ—ñ–∫—Å—ñ–≤, –ø–æ–≤—Ç–æ—Ä—ñ–≤**

---

## üìò –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–¥—É–ª—è

> –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **Z-—Ñ—É–Ω–∫—Ü—ñ—é** –¥–ª—è —Ä—è–¥–∫–∞ `S`, —è–∫–∞ –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø–æ–∑–∏—Ü—ñ—ó `i` –ø–æ–≤–µ—Ä—Ç–∞—î –¥–æ–≤–∂–∏–Ω—É –Ω–∞–π–±—ñ–ª—å—à–æ–≥–æ –ø—Ä–µ—Ñ—ñ–∫—Å–∞, —â–æ –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ —Å—É—Ñ—ñ–∫—Å–æ–º, –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ `i`.  
> –ú–µ—Ç–∞ ‚Äî –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –º–∞—Å–∏–≤ `Z[i]`, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î:
- –ó–Ω–∞—Ö–æ–¥–∏—Ç–∏ –≤—Ö–æ–¥–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –≤ —Ç–µ–∫—Å—Ç  
- –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–≤—Ç–æ—Ä–∏, –ø—Ä–µ—Ñ—ñ–∫—Å–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä—è–¥–∫–∞  
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ –∑–∞–¥–∞—á–∞—Ö –ø–æ—à—É–∫—É, –ø–∞—Ä—Å–∏–Ω–≥—É, –ø–æ–±—É–¥–æ–≤–∏ —Å—É—Ñ—ñ–∫—Å–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä

---

## üß† –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ –ª–æ–≥—ñ–∫–∞ (—Ä–æ–∑—à–∏—Ä–µ–Ω–∞)

### üìê –ú–æ–¥–µ–ª—å

- **–í—Ö—ñ–¥**: —Ä—è–¥–æ–∫ `S` –¥–æ–≤–∂–∏–Ω–∏ `n`  
- **–í–∏—Ö—ñ–¥**: –º–∞—Å–∏–≤ `Z[n]`, –¥–µ `Z[i]` ‚Äî –¥–æ–≤–∂–∏–Ω–∞ –Ω–∞–π–±—ñ–ª—å—à–æ–≥–æ –ø—Ä–µ—Ñ—ñ–∫—Å–∞, —â–æ –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ `S[i..n-1]`

- **–Ü–Ω–≤–∞—Ä—ñ–∞–Ω—Ç**:  
  - `Z[0] = 0`  
  - –î–ª—è `i > 0`:  
    - –Ø–∫—â–æ `i ‚â§ r`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è  
    - –Ü–Ω–∞–∫—à–µ ‚Äî –≤–∏–∫–æ–Ω—É—î–º–æ –ø—Ä—è–º–µ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

---

### üîÅ –õ–æ–≥—ñ–∫–∞

- –í—ñ–∫–Ω–æ `[l, r]` ‚Äî –ø–æ—Ç–æ—á–Ω–∏–π –∑–±—ñ–≥  
- –Ø–∫—â–æ `i ‚â§ r`, –±–µ—Ä–µ–º–æ `Z[i - l]`, –∞–ª–µ –Ω–µ –≤–∏—Ö–æ–¥–∏–º–æ –∑–∞ –º–µ–∂—ñ `r`  
- –ü–æ—Ç—ñ–º —Ä–æ–∑—à–∏—Ä—é—î–º–æ –∑–±—ñ–≥ –≤—Ä—É—á–Ω—É, –ø–æ–∫–∏ `S[Z[i]] == S[i + Z[i]]`

---

### üìä –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü—ñ—è     | –ß–∞—Å     | –ü–∞–º‚Äô—è—Ç—å |
|--------------|---------|---------|
| –ü–æ–±—É–¥–æ–≤–∞ Z   | `O(n)`  | `O(n)`  |

- –ö–æ–∂–µ–Ω —Å–∏–º–≤–æ–ª –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –Ω–µ –±—ñ–ª—å—à–µ –¥–≤–æ—Ö —Ä–∞–∑—ñ–≤  
- –ü—Ä–∞—Ü—é—î –∑–∞ –ª—ñ–Ω—ñ–π–Ω–∏–π —á–∞—Å

---

## üíª –ö–æ–¥ –Ω–∞ C

```c
#include <stdio.h>
#include <string.h>

#define MAX_LEN 1000

void compute_z_function(const char *s, int *z) {
    int n = strlen(s);
    int l = 0, r = 0;
    z[0] = 0;

    for (int i = 1; i < n; i++) {
        if (i <= r)
            z[i] = (z[i - l] < r - i + 1) ? z[i - l] : r - i + 1;
        while (i + z[i] < n && s[z[i]] == s[i + z[i]])
            z[i]++;
        if (i + z[i] - 1 > r) {
            l = i;
            r = i + z[i] - 1;
        }
    }
}

// üîß –¢–µ—Å—Ç
void run_test() {
    const char *s = "ababcababc";
    int z[MAX_LEN];
    compute_z_function(s, z);

    printf("Z-function for \"%s\":\n", s);
    for (int i = 0; i < strlen(s); i++)
        printf("Z[%d] = %d\n", i, z[i]);
}

int main() {
    run_test();
    return 0;
}

```


## üß™ –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ

| –†—è–¥–æ–∫         | Z-–º–∞—Å–∏–≤                   |
|---------------|---------------------------|
| `"aaaaa"`     | `0 4 3 2 1`               |
| `"ababcababc"`| `0 0 1 0 3 0 1 0 2 0`     |
| `"abcababc"`  | `0 0 0 1 2 0 3 0`         |

- `Z[i]` –ø–æ–∫–∞–∑—É—î –¥–æ–≤–∂–∏–Ω—É –∑–±—ñ–≥—É –∑ –ø–æ—á–∞—Ç–∫—É —Ä—è–¥–∫–∞ `S[0..]` —ñ —Å—É—Ñ—ñ–∫—Å–æ–º `S[i..]`  
- –Ø–∫—â–æ `Z[i] == len(pattern)` ‚Äî —Ü–µ –≤—Ö–æ–¥–∂–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –≤ —Ç–µ–∫—Å—Ç  
- –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –ø–æ—à—É–∫—É `"abc"` –≤ `"abcababc"` ‚Üí `Z[5] == 3` ‚Üí –≤—Ö–æ–¥–∂–µ–Ω–Ω—è –∑ —ñ–Ω–¥–µ–∫—Å—É `5`

---

## üì¶ –ü–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

–ú–æ–¥—É–ª—å –º–æ–∂–Ω–∞ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –¥–ª—è:

- **–ü–æ—à—É–∫—É —à–∞–±–ª–æ–Ω—É –≤ —Ç–µ–∫—Å—Ç—ñ** ‚Äî —á–µ—Ä–µ–∑ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—é `pattern + '#' + text`  
- **–ü–æ–±—É–¥–æ–≤–∏ —Å—É—Ñ—ñ–∫—Å–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä** ‚Äî —è–∫ —á–∞—Å—Ç–∏–Ω–∞ —Å—É—Ñ—ñ–∫—Å–Ω–æ–≥–æ –º–∞—Å–∏–≤—É –∞–±–æ –¥–µ—Ä–µ–≤–∞  
- **–ê–Ω–∞–ª—ñ–∑—É –ø–æ–≤—Ç–æ—Ä—ñ–≤, –ø—Ä–µ—Ñ—ñ–∫—Å—ñ–≤, —Å–∏–º–µ—Ç—Ä—ñ–π** ‚Äî –≤ –∑–∞–¥–∞—á–∞—Ö –Ω–∞ —Å—Ç—Ä–æ–∫–∏, –î–ù–ö, —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è  
- **–í–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –≤ –ø–∞—Ä—Å–µ—Ä–∏, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∏, IDE** ‚Äî –¥–ª—è –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è, –ø—ñ–¥—Å–≤—ñ—Ç–∫–∏, –ø–æ—à—É–∫—É  
- **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ —ñ–Ω—à–∏–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏** ‚Äî KMP, Rabin-Karp, —Å—É—Ñ—ñ–∫—Å–Ω—ñ –º–∞—Å–∏–≤–∏

---

## üßò –í–∏—Å–Ω–æ–≤–æ–∫

–¶–µ–π –º–æ–¥—É–ª—å ‚Äî –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è Z-—Ñ—É–Ω–∫—Ü—ñ—ó. –í—ñ–Ω –ø–æ–∫–∞–∑—É—î:

- –Ø–∫ **–ø–æ–±—É–¥—É–≤–∞—Ç–∏ –º–∞—Å–∏–≤ –∑–±—ñ–≥—ñ–≤ –∑–∞ `O(n)`**  
- –Ø–∫ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –≤ –∑–∞–¥–∞—á–∞—Ö –ø–æ—à—É–∫—É —ñ –ø–∞—Ä—Å–∏–Ω–≥—É**  
- –Ø–∫ **—Å—Ç—Ä—É–∫—Ç—É—Ä—É–≤–∞—Ç–∏ –∫–æ–¥ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**  
- –Ø–∫ **–º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –≤–µ–ª–∏–∫—ñ —Ä—è–¥–∫–∏ —ñ –ø–æ—Ç–æ–∫–∏**  
- –Ø–∫ **—ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ Z-—Ñ—É–Ω–∫—Ü—ñ—é –≤ —Å–∏—Å—Ç–µ–º–∏ –∞–Ω–∞–ª—ñ–∑—É —Ç–µ–∫—Å—Ç—É, –ø–æ—à—É–∫—É, –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó**

–¶–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∫–∞ ‚Äî —Ü–µ **–±–∞–∑–æ–≤–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ä—è–¥–∫–∞–º–∏**, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–π –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–æ —á–∏—Å—Ç–æ, –≥–æ—Ç–æ–≤–∏–π –¥–æ –ø—Ä–æ–¥–∞–∫—à–Ω—É.


---
